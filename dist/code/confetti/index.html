<!DOCTYPE html>
<html>
  <head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>Creations | Suskitech.Org</title>
	<meta name="description" content="			Recently, I found myself needing to rebuild a confetti effect, the old one used css and had broken at some point during a stack upgrade. I decided it woul...">
	<meta name="keywords" content="suski,suskitech,suski technical services,nicholas,code,web,web developer,art,music,jewelry">

	<!-- jQuery -->
	<script src="/js/jquery-2.1.4.min.js"></script>

	<!-- Bootstrap -->
	<link rel="stylesheet" href="/css/bootstrap.min.css">
	<link rel="stylesheet" href="/css/bootstrap-margin-padding-classes.css">
	<script src="/js/bootstrap.min.js"></script>

	<!-- Google Fonts -->
	<link href='https://fonts.googleapis.com/css?family=Merriweather' rel='stylesheet' type='text/css'>
	<link href='https://fonts.googleapis.com/css?family=Josefin+Sans:400' rel='stylesheet' type='text/css'>
	<link href='https://fonts.googleapis.com/css?family=Josefin+Sans:600' rel='stylesheet' type='text/css'>

	<!-- Animate.css -->
	<link rel="stylesheet" href="/css/animate.css">

	<!-- Site Styles -->
	<link rel="stylesheet" href="/css/main.css">

	<!-- Canonicals -->
	<!-- <link rel="canonical" href="http://suskitech.org/code/confetti/"> -->
	<link rel="alternate" type="application/rss+xml" title="Creations | Suskitech.Org" href="http://suskitech.org/feed.xml" />

	<!-- Slick Gallery -->
	<script src="/js/slick.min.js"></script>
	<link rel="stylesheet" href="/css/slick-theme.css">

	<!-- Site Actions.js -->
	<script src="/js/actions.js"></script>

	<!-- Google Analytics -->
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-35128335-1', 'auto');
	  ga('send', 'pageview');
	</script>

</head>
  <body>
    <div class="container shadow-5 vignette"><!-- OPEN CONTAINER HERE -->
  <header id="header" class="clearfix">
    <h1 class="title"><a href="/" title="home">Creations</a></h1>
    <div class="tagline">
      <div class="name">
        <span class="hidden-xs">-&nbsp;</span><a href="#" class="site-email-address" data-email="006e00690063006b" data-domain="007300750073006b00690074006500630068002e006f00720067" title="Email Me" target="_blank">Nicholas Suski</a>
      </div>
    </div>
  </header>
  <nav>
    <div class="navbar-header">
      <div class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navigation" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <a id="nav-toggle" href="#"><span></span></a>
      </div>
    </div>
    <ul class="collapse navbar-collapse" id="main-navigation">
      
        
          
            <li><a href="/blog/" title="Blog">Blog<span class="bar"></span></a></li>
          
        
      
        
          
            <li><a href="/code/" title="Code" class="active">Code<span class="bar"></span></a></li>
          
        
      
        
      
        
      
        
          
            <li><a href="/images/" title="Images">Images<span class="bar"></span></a></li>
          
        
      
        
      
        
          
            <li><a href="/jewelry/" title="Jewelry">Jewelry<span class="bar"></span></a></li>
          
        
      
        
      
        
          
            <li><a href="/music/" title="Music">Music<span class="bar"></span></a></li>
          
        
      
        
      
        
      
        
      
        
          
            <li><a href="/video/" title="Video">Video<span class="bar"></span></a></li>
          
        
      
        
          
            <li><a href="/websites/" title="Websites">Websites<span class="bar"></span></a></li>
          
        
      
    </ul>
    <div class="header-social">
      <div class="icons">
        <a href="#" class="site-email-address email" data-email="006e00690063006b" data-domain="007300750073006b00690074006500630068002e006f00720067" title="Email Me" target="_blank">
          <div class="icon icon-email">
            <svg fill="#aaa" viewBox="100 125 312 260">
              <path d="M101.3 141.6v228.9h0.3 308.4 0.8V141.6H101.3zM375.7 167.8l-119.7 91.5 -119.6-91.5H375.7zM127.6 194.1l64.1 49.1 -64.1 64.1V194.1zM127.8 344.2l84.9-84.9 43.2 33.1 43-32.9 84.7 84.7L127.8 344.2 127.8 344.2zM384.4 307.8l-64.4-64.4 64.4-49.3V307.8z"/>
            </svg>
          </div>
        </a>
        <a href="https://www.linkedin.com/in/nicholas-suski-75188b119" class="linkedin" title="View My Linekdin Profile" target="_blank">
          <div class="icon icon-linkedin">
            <svg viewBox="100 100 320 320">
              <path fill="#aaa" d="M186.4 142.4c0 19-15.3 34.5-34.2 34.5 -18.9 0-34.2-15.4-34.2-34.5 0-19 15.3-34.5 34.2-34.5C171.1 107.9 186.4 123.4 186.4 142.4zM181.4 201.3h-57.8V388.1h57.8V201.3zM273.8 201.3h-55.4V388.1h55.4c0 0 0-69.3 0-98 0-26.3 12.1-41.9 35.2-41.9 21.3 0 31.5 15 31.5 41.9 0 26.9 0 98 0 98h57.5c0 0 0-68.2 0-118.3 0-50-28.3-74.2-68-74.2 -39.6 0-56.3 30.9-56.3 30.9v-25.2H273.8z"/>
            </svg>
          </div>
        </a>
        <a href="http://codepen.io/n33kos" class="codepen" target="_blank" title="Find Me On Codepen">
          <div class="icon icon-codepen">
            <svg viewBox="75 75 375 437">
              <path fill="#aaa" d="M427 201.9c-0.6-4.2-2.9-8-6.4-10.3L264.2 87.3c-4.9-3.3-11.4-3.3-16.3 0L91.4 191.6c-4 2.7-6.5 7.4-6.5 12.2v104.3c0 4.8 2.5 9.6 6.5 12.2l156.4 104.3c4.9 3.3 11.4 3.3 16.3 0L420.6 320.4c4-2.6 6.6-7.4 6.6-12.2V203.9C427.1 203.2 427.1 202.6 427 201.9 427 201.7 427.1 202.6 427 201.9zM270.7 127.1l115.2 76.8 -51.5 34.4 -63.8-42.7V127.1zM241.3 127.1v68.6l-63.8 42.7 -51.5-34.4L241.3 127.1zM114.3 231.4l36.8 24.6 -36.8 24.6V231.4zM241.3 384.9L126.1 308.1l51.5-34.4 63.8 42.6V384.9zM256 290.8l-52-34.8 52-34.8 52 34.8L256 290.8zM270.7 384.9V316.3l63.8-42.6 51.5 34.4L270.7 384.9zM397.7 280.6l-36.8-24.6 36.8-24.6V280.6z"/>
            </svg>
          </div>
        </a>
        <a href="https://github.com/n33kos" class="github" target="_blank" title="Find Me On Github">
          <div class="icon icon-github">
            <svg viewBox="0 0 16 16">
              <path fill="#aaa" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </div>
        </a>
      </div>
    </div>
  </nav>

    
<div id="post-page">
  <div class="codepen-embed">
    <p data-height="600" data-theme-id="25948" data-slug-hash="gjVQwv" data-default-tab="result" data-user="n33kos" data-embed-version="2" class="codepen"></p>
    <script async src="//assets.codepen.io/assets/embed/ei.js"></script>
  </div>

  <div class="content margin-top-35">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
        <div class="post">
            <h2 class="post-title margin-bottom-10">Canvas Confetti</h2>
            <p class="post-meta margin-0">Aug 16, 2018</p>
            <hr>
            <div class="post-content margin-top-5">
              <div class="margin-bottom-15">
	<p>
		Recently, I found myself needing to rebuild a confetti effect, the old one used css and had broken at some point during a stack upgrade. I decided it would be most efficient to use canvas over DOM elements so I fired up my trusty canvas2D template and got to work. I wanted implementation to be rapid so I decided to stick with square and rectangular confetti pieces. First we declare some variables, grabbing the canvas element and the 2D context. The confetti variable is an array of confetti objects which we will be mutating, the rest are constants to control the confetti count, global physics, and colors.
	</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">	<span class="nx">canvas</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"canvas"</span><span class="p">);</span>
	<span class="nx">ctx</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">"2d"</span><span class="p">);</span>
	<span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">;</span>
	<span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">;</span>
	<span class="nx">cx</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
	<span class="nx">cy</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>

	<span class="kd">let</span> <span class="nx">confetti</span> <span class="o">=</span> <span class="p">[];</span>
	<span class="kd">const</span> <span class="nx">confettiCount</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>
	<span class="kd">const</span> <span class="nx">gravity</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
	<span class="kd">const</span> <span class="nx">terminalVelocity</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
	<span class="kd">const</span> <span class="nx">drag</span> <span class="o">=</span> <span class="mf">0.075</span><span class="p">;</span>
	<span class="kd">const</span> <span class="nx">colors</span> <span class="o">=</span> <span class="p">[</span>
	  <span class="p">{</span> <span class="na">front</span> <span class="p">:</span> <span class="s1">'red'</span><span class="p">,</span> <span class="na">back</span><span class="p">:</span> <span class="s1">'darkred'</span><span class="p">},</span>
	  <span class="p">{</span> <span class="na">front</span> <span class="p">:</span> <span class="s1">'green'</span><span class="p">,</span> <span class="na">back</span><span class="p">:</span> <span class="s1">'darkgreen'</span><span class="p">},</span>
	  <span class="p">{</span> <span class="na">front</span> <span class="p">:</span> <span class="s1">'blue'</span><span class="p">,</span> <span class="na">back</span><span class="p">:</span> <span class="s1">'darkblue'</span><span class="p">},</span>
	  <span class="p">{</span> <span class="na">front</span> <span class="p">:</span> <span class="s1">'yellow'</span><span class="p">,</span> <span class="na">back</span><span class="p">:</span> <span class="s1">'darkyellow'</span><span class="p">},</span>
	  <span class="p">{</span> <span class="na">front</span> <span class="p">:</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="na">back</span><span class="p">:</span> <span class="s1">'darkorange'</span><span class="p">},</span>
	  <span class="p">{</span> <span class="na">front</span> <span class="p">:</span> <span class="s1">'pink'</span><span class="p">,</span> <span class="na">back</span><span class="p">:</span> <span class="s1">'darkpink'</span><span class="p">},</span>
	  <span class="p">{</span> <span class="na">front</span> <span class="p">:</span> <span class="s1">'purple'</span><span class="p">,</span> <span class="na">back</span><span class="p">:</span> <span class="s1">'darkpurple'</span><span class="p">},</span>
	  <span class="p">{</span> <span class="na">front</span> <span class="p">:</span> <span class="s1">'turquoise'</span><span class="p">,</span> <span class="na">back</span><span class="p">:</span> <span class="s1">'darkturquoise'</span><span class="p">},</span>
	<span class="p">];</span></code></pre></figure>

	<p>
		Next we populate the confetti array with objects. We choose a random color, dimension, and rotation. The rotation is a random number between 0 and 360 degrees but the canvas rotate method uses radians so I choose a random number between 0 and 2 * Math.PI. The position starts 1px above the bottom of the canvas since later we destroy confetti which hits the bottom. The scale is 1 in both axes because we multiply the dimensions by the scale. Last we set a random velocity which sends the confetti shooting upward when we render. You'll notice I use the randomRange method a lot, it's a helper I created to give me a random number from a negative or positive range.
	</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">	<span class="nx">initConfetti</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
	  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">confettiCount</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
	    <span class="nx">confetti</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
	      <span class="na">color</span>      <span class="p">:</span> <span class="nx">colors</span><span class="p">[</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">randomRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">colors</span><span class="p">.</span><span class="nx">length</span><span class="p">))],</span>
	      <span class="na">dimensions</span> <span class="p">:</span> <span class="p">{</span>
	        <span class="na">x</span><span class="p">:</span> <span class="nx">randomRange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
	        <span class="na">y</span><span class="p">:</span> <span class="nx">randomRange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
	      <span class="p">},</span>
	      <span class="na">position</span>   <span class="p">:</span> <span class="p">{</span>
	        <span class="na">x</span><span class="p">:</span> <span class="nx">randomRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">),</span>
	        <span class="na">y</span><span class="p">:</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
	      <span class="p">},</span>
	      <span class="na">rotation</span>   <span class="p">:</span> <span class="nx">randomRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">),</span>
	      <span class="na">scale</span>      <span class="p">:</span> <span class="p">{</span>
	        <span class="na">x</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
	        <span class="na">y</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
	      <span class="p">},</span>
	      <span class="na">velocity</span>   <span class="p">:</span> <span class="p">{</span>
	        <span class="na">x</span><span class="p">:</span> <span class="nx">randomRange</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
	        <span class="na">y</span><span class="p">:</span> <span class="nx">randomRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">),</span>
	      <span class="p">},</span>
	    <span class="p">});</span>
	  <span class="p">}</span>
	<span class="p">}</span>

	<span class="nx">randomRange</span> <span class="o">=</span> <span class="p">(</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">max</span> <span class="o">-</span> <span class="nx">min</span><span class="p">)</span> <span class="o">+</span> <span class="nx">min</span></code></pre></figure>

	<p>
		Now we need to implement all the fun stuff in the render method. I want to make the confetti explode upward as if shot by a cannon, then float downward slowly. We start by clearing the canvas, then open a foreach to render each confetto. The canvas context has a translate and rotate method but the both work relative to the top left corner. In order to render each rectangles rotation we move the entire canvas to the confetto's position, then rotate the canvas.
	</p>

	<p>
		Next we process the velocity of the confetto, horizontal momentum is dampened over time and randomized to simulate the breeze pushing the confetti around. Vertical momentum is increased by adding gravity until terminal velocity is reached. Now we set the new position of the piece by adding velocity to the position. If a piece is lower than the bottom of the screen, it is removed from the array to improve performance. If a confetto floats out of the screen horizontally it is looped to the other side.
	</p>

	<p>
		At this point the confetti would float but it would never look like it was spinning in the wind. I simulate this by modifying the confetto's scale in the Y axis using <code class="inline">Math.cos()</code> on the confetto's Y position. The end result is that the scale alternates between -1 and 1 as its Y position changes, making the spin relative to the piece's vertical movement speed. To add depth we darken the confetto's color when it's scale is negative.
	</p>

	<p>
		Last, we draw the rectangle with <code class="inline">fillRect()</code> then reset the context's transform matrix which resets the translation and rotation. The only thing left is to fire off another round of confetti when the count gets below 10 and call the animation frame again.
	</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">	<span class="nx">render</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
	  <span class="nx">ctx</span><span class="p">.</span><span class="nx">clearRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>

	  <span class="nx">confetti</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">confetto</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
	    <span class="kd">let</span> <span class="nx">width</span> <span class="o">=</span> <span class="p">(</span><span class="nx">confetto</span><span class="p">.</span><span class="nx">dimensions</span><span class="p">.</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">confetto</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span>
	    <span class="kd">let</span> <span class="nx">height</span> <span class="o">=</span> <span class="p">(</span><span class="nx">confetto</span><span class="p">.</span><span class="nx">dimensions</span><span class="p">.</span><span class="nx">y</span> <span class="o">*</span> <span class="nx">confetto</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>

	    <span class="c1">// Move canvas to position and rotate</span>
	    <span class="nx">ctx</span><span class="p">.</span><span class="nx">translate</span><span class="p">(</span><span class="nx">confetto</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">confetto</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
	    <span class="nx">ctx</span><span class="p">.</span><span class="nx">rotate</span><span class="p">(</span><span class="nx">confetto</span><span class="p">.</span><span class="nx">rotation</span><span class="p">);</span>

	    <span class="c1">// Apply forces to velocity</span>
	    <span class="nx">confetto</span><span class="p">.</span><span class="nx">velocity</span><span class="p">.</span><span class="nx">x</span> <span class="o">-=</span> <span class="nx">confetto</span><span class="p">.</span><span class="nx">velocity</span><span class="p">.</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">drag</span><span class="p">;</span>
	    <span class="nx">confetto</span><span class="p">.</span><span class="nx">velocity</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="p">?</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="p">:</span> <span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
	    <span class="nx">confetto</span><span class="p">.</span><span class="nx">velocity</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">confetto</span><span class="p">.</span><span class="nx">velocity</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">gravity</span><span class="p">,</span> <span class="nx">terminalVelocity</span><span class="p">);</span>

	    <span class="c1">// Set position</span>
	    <span class="nx">confetto</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="nx">confetto</span><span class="p">.</span><span class="nx">velocity</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
	    <span class="nx">confetto</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="nx">confetto</span><span class="p">.</span><span class="nx">velocity</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>

	    <span class="c1">// Delete confetti when out of frame</span>
	    <span class="k">if</span> <span class="p">(</span><span class="nx">confetto</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">&gt;=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="nx">confetti</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	    <span class="c1">// Loop confetto x position</span>
	    <span class="k">if</span> <span class="p">(</span><span class="nx">confetto</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="nx">confetto</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	    <span class="k">if</span> <span class="p">(</span><span class="nx">confetto</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">confetto</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>

	    <span class="c1">// Spin confetto by scaling y</span>
	    <span class="nx">confetto</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">confetto</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">);</span>
	    <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="nx">confetto</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">?</span> <span class="nx">confetto</span><span class="p">.</span><span class="nx">color</span><span class="p">.</span><span class="nx">front</span> <span class="p">:</span> <span class="nx">confetto</span><span class="p">.</span><span class="nx">color</span><span class="p">.</span><span class="nx">back</span><span class="p">;</span>

	    <span class="c1">// Draw confetto</span>
	    <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="o">-</span><span class="nx">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="nx">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">);</span>

	    <span class="c1">// Reset transform matrix</span>
	    <span class="nx">ctx</span><span class="p">.</span><span class="nx">setTransform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	  <span class="p">});</span>

	  <span class="c1">// Fire off another round of confetti</span>
	  <span class="k">if</span> <span class="p">(</span><span class="nx">confetti</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">)</span> <span class="nx">initConfetti</span><span class="p">();</span>

	  <span class="nb">window</span><span class="p">.</span><span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">render</span><span class="p">);</span>
	<span class="p">}</span></code></pre></figure>
</div>

            </div>
        </div>
        <div class="post-navigation">
          
            <a class="prev" href="/code/magicus/">&larr; Magicus</a>
          
          
        </div>
      </div>
    </div>
  </div>
</div>

      <footer class="footer">
    <div class="bar"></div>
    <div class="row">
      <div class="col-xs-12 col-sm-6 social">
        <div class="icons">
          <a href="https://github.com/n33kos" class="github" target="_blank" title="Find Me On Github">
            <div class="icon icon-github">
              <svg viewBox="0 0 16 16">
                <path fill="#aaa" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </div>
          </a>
          <a href="http://codepen.io/n33kos" class="codepen" target="_blank" title="Find Me On Codepen">
            <div class="icon icon-codepen">
              <svg viewBox="75 75 375 437">
                <path fill="#aaa" d="M427 201.9c-0.6-4.2-2.9-8-6.4-10.3L264.2 87.3c-4.9-3.3-11.4-3.3-16.3 0L91.4 191.6c-4 2.7-6.5 7.4-6.5 12.2v104.3c0 4.8 2.5 9.6 6.5 12.2l156.4 104.3c4.9 3.3 11.4 3.3 16.3 0L420.6 320.4c4-2.6 6.6-7.4 6.6-12.2V203.9C427.1 203.2 427.1 202.6 427 201.9 427 201.7 427.1 202.6 427 201.9zM270.7 127.1l115.2 76.8 -51.5 34.4 -63.8-42.7V127.1zM241.3 127.1v68.6l-63.8 42.7 -51.5-34.4L241.3 127.1zM114.3 231.4l36.8 24.6 -36.8 24.6V231.4zM241.3 384.9L126.1 308.1l51.5-34.4 63.8 42.6V384.9zM256 290.8l-52-34.8 52-34.8 52 34.8L256 290.8zM270.7 384.9V316.3l63.8-42.6 51.5 34.4L270.7 384.9zM397.7 280.6l-36.8-24.6 36.8-24.6V280.6z"/>
              </svg>
            </div>
          </a>
          <a href="https://www.linkedin.com/in/nicholas-suski-75188b119" class="linkedin" title="View My Linekdin Profile" target="_blank">
            <div class="icon icon-linkedin">
              <svg viewBox="100 100 320 320">
                <path fill="#aaa" d="M186.4 142.4c0 19-15.3 34.5-34.2 34.5 -18.9 0-34.2-15.4-34.2-34.5 0-19 15.3-34.5 34.2-34.5C171.1 107.9 186.4 123.4 186.4 142.4zM181.4 201.3h-57.8V388.1h57.8V201.3zM273.8 201.3h-55.4V388.1h55.4c0 0 0-69.3 0-98 0-26.3 12.1-41.9 35.2-41.9 21.3 0 31.5 15 31.5 41.9 0 26.9 0 98 0 98h57.5c0 0 0-68.2 0-118.3 0-50-28.3-74.2-68-74.2 -39.6 0-56.3 30.9-56.3 30.9v-25.2H273.8z"/>
              </svg>
            </div>
          </a>
          <a href="#" class="site-email-address email" data-email="006e00690063006b" data-domain="007300750073006b00690074006500630068002e006f00720067" title="Email Me" target="_blank">
            <div class="icon icon-email">
              <svg fill="#aaa" viewBox="100 125 312 260">
                <path d="M101.3 141.6v228.9h0.3 308.4 0.8V141.6H101.3zM375.7 167.8l-119.7 91.5 -119.6-91.5H375.7zM127.6 194.1l64.1 49.1 -64.1 64.1V194.1zM127.8 344.2l84.9-84.9 43.2 33.1 43-32.9 84.7 84.7L127.8 344.2 127.8 344.2zM384.4 307.8l-64.4-64.4 64.4-49.3V307.8z"/>
              </svg>
            </div>
          </a>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 copy">
        <div class="margin-top-10 disc">
          &copy; 2018 Suski Technical Services. All Rights Reserved.
        </div>
      </div>
    </div>
  </footer>
</div><!-- CLOSE CONTAINER HERE -->

  </body>
</html>